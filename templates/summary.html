{% extends "layout.html" %}

{% block title %}
Summary
{% endblock %}

{% block main %}
<h1>Summary</h1>
<div class="summary-container-options">
    <form class="form-v2" action="/summary" method="post">
        <select id="dropdown-year" class="filter" name="year">
            <!-- {% for year in years %} -->
            <!-- <option value="{{ year }}">{{ year }}</option> -->
            <!-- {% endfor %} -->
            <option value="2024">2024</option>
        </select>
        <select id="dropdown-month" class="filter" name="month">
            <option value="01">January</option>
        </select>
    </form>
</div>
<div class="summary-container-graphs">
    <canvas id="pieChart"></canvas>
    <canvas id="barChart"></canvas>
</div>
<div class="summary-container-expenses">

</div>

<script>
    const expenses = {{ expenses | tojson }};

    // Colors used for the pie chart 
    var barColors = [
        "#b91d47",
        "#00aba9",
        "#2b5797",
        "#e8c3b9",
        "#1e7145"
        ];

    // Create arrays containing the categories and expenses of the user that month
    const categories = expenses.map(e => e[0]);
    const totals = expenses.map(e => e[1]);

    // Create the pie chart
    const ctxPie = document.getElementById('pieChart').getContext('2d');
    const pieChart = new Chart(ctxPie, {
        type: "pie",
        data: {
            labels: categories,
            datasets: [{
                data: totals,
                backgroundColor: barColors,
            }]
        },
        options: {
            title: {
                display: true,
                text: "Basic Pie Chart"
            },
            responsive: true,
            plugins: {
                legend: {
                    position: 'top',
                },
            }
        }
    });

    // Create the bar chart
    const ctxBar = document.getElementById('barChart').getContext('2d');
    const barChart = new Chart(ctxBar, {
        type: "bar",
        data: {
            labels: categories,
            datasets: [{
                label: "Total Expenses",
                data: totals,
                backgroundColor: ["#36a2eb"],
                borderColor: ["#36a2eb"],
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });
</script>

{% endblock %}